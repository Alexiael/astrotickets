---
const { title = "AstroTickets – Galactic Force Fest" } = Astro.props;
import "../styles/global.css";
---

<!doctype html>
<html lang="es" class="text-(--color-text-primary)">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{title}</title>
  </head>

  <body class={`min-h-screen flex flex-col relative ${Astro.url.pathname === "/" ? "no-scroll" : ""}`}>

    <!-- Fondo estrellado -->
    <div class="starfield"></div>

    <!-- HEADER -->
    <header
      class="sticky top-0 z-50
             border-b border-(--color-border-accent)
             bg-black/80 backdrop-blur"
    >
      <nav class="w-full px-4 py-3
         flex items-center">
        <!-- IZQUIERDA: LOGO -->
        <div class="flex items-center gap-2">
          <a href="/" class="flex items-center gap-2">
            <span
              class="h-8 w-8 rounded-full border
               border-(--color-border-accent)
               flex items-center justify-center
               text-xs tracking-[0.2em]
               text-(--color-accent)"
            >
              SW
            </span>

            <span
              class="font-semibold tracking-[0.2em] uppercase text-sm
               text-(--color-accent)"
            >
              AstroTickets
            </span>
          </a>
        </div>

        <!-- CENTRO: MENÚ -->
        <div class="flex-1 flex justify-center">
          <ul
            id="mobile-menu"
            class="hidden
             absolute top-full left-0 w-full
             flex-col gap-4 px-6 py-6
             bg-black/95 backdrop-blur
             border-b border-(--color-border-accent)
             text-sm tracking-wide
             md:static md:flex md:flex-row md:gap-6
             md:w-auto md:p-0 md:bg-transparent md:border-none"
          >
            <li>
              <a href="/events" class="hover:text-(--color-accent-soft)"
                >Entradas</a>
            </li>
            <li>
              <a href="/merch" class="hover:text-(--color-accent-soft)"
                >Tienda</a>
            </li>
            <li>
              <a href="/dashboard" class="hover:text-(--color-accent-soft)"
                >Dashboard</a>
            </li>
            <li>
              <a href="/community" class="hover:text-(--color-accent-soft)"
                >Comunidad</a>
            </li>
            <li>
              <a href="/location" class="hover:text-(--color-accent-soft)"
                >Ubicación</a>
            </li>
            <li>
              <a href="/about" class="hover:text-(--color-accent-soft)"
                >Sobre nosotros</a>
            </li>
            <li>
              <a href="/contact" class="hover:text-(--color-accent-soft)"
                >Contacto</a>
            </li>
          </ul>
        </div>

        <!-- DERECHA: CONTROLES -->
        <div class="flex items-center gap-3">
          <!-- BOTÓN MÓVIL -->
          <button
            id="menu-toggle"
            aria-label="Abrir menú"
            aria-expanded="false"
            class="md:hidden border
             border-(--color-border-accent)
             px-3 py-1 rounded
             text-xs tracking-wide
             text-(--color-accent)
             hover:bg-(--color-accent)/10
             transition"
          >
            Menú
          </button>

          <!-- SWITCH -->
          <div class="flex items-center gap-2">
            <span
              class="text-xs tracking-[0.25em] uppercase text-(--color-text-muted)"
            >
              Rebelión
            </span>

            <label class="switch">
              <input type="checkbox" id="theme-toggle" />
              <span class="slider"></span>
            </label>

            <span
              class="text-xs tracking-[0.25em] uppercase text-(--color-text-muted)"
            >
              Imperio
            </span>
          </div>
        </div>
      </nav>
    </header>

    <!-- MAIN -->
    <main class="relative z-10 flex-1">
      <slot />
    </main>

    <!-- FOOTER -->
    <footer
      class={`relative z-10
          border-t border-(--color-border-accent)
          bg-black/80
          ${Astro.url.pathname === "/" ? "mt-2" : "mt-8"}`}
    >
      <div
        class="max-w-6xl mx-auto px-4 py-6 text-xs
               text-(--color-text-muted)
               flex flex-col md:flex-row gap-2
               md:items-center md:justify-between"
      >
        <p>© {new Date().getFullYear()} AstroTickets – Galactic Force Fest.</p>
        <p>Virginia Muñoz Gil</p>
      </div>
    </footer>

    <!-- SCRIPT MENÚ MÓVIL -->
    <script is:inline>
      const toggle = document.getElementById("menu-toggle");
      const menu = document.getElementById("mobile-menu");

      if (toggle && menu) {
        toggle.addEventListener("click", () => {
          const isOpen = !menu.classList.contains("hidden");
          menu.classList.toggle("hidden");
          toggle.setAttribute("aria-expanded", String(!isOpen));
        });
      }
    </script>

    <!-- SCRIPT TEMA -->
    <script is:inline>
      const checkbox = document.getElementById("theme-toggle");
      const html = document.documentElement;

      const savedTheme = localStorage.getItem("theme") || "rebelion";
      html.setAttribute("data-theme", savedTheme);

      checkbox.checked = savedTheme === "imperio";

      checkbox.addEventListener("change", () => {
        const next = checkbox.checked ? "imperio" : "rebelion";
        html.setAttribute("data-theme", next);
        localStorage.setItem("theme", next);
      });
    </script>
  </body>
</html>
